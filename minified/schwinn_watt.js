var rideID=window.location.pathname.split("/");fetch("https://api.onepeloton.com/api/ride/"+(rideID=rideID[rideID.length-1])+"/details?stream_source=multichannel",{headers:{accept:"application/json, text/plain, */*","accept-language":"en-US","peloton-platform":"web","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","x-requested-with":"XmlHttpRequest"},referrer:"https://members.onepeloton.com/classes/player/"+rideID,referrerPolicy:"no-referrer-when-downgrade",body:null,method:"GET",mode:"cors",credentials:"include"}).then(function(e){return e.json()}).then(function(e){var t=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,4,5,6,7,8,10,11,13,13,14,15,16,17,18,19,21,22,24,25,27,28,30,31,33,34,36,37,39,40,42,43,45,46,48,49,51,52,54,55,57,58,60,61,63,64,66,67,69,70,72,73,75,76,78,79,81,82,84,85,87,88,90,91,93,94,96,97,99,100],r=Number(e.ride.duration),s=document.createElement("div");s.id="cadresist",s.style="color:white; position:absolute; top: 5%; left:36%; margin-top: 35px",s.innerHTML='<div id="cadresisttxt" style="width:100%;color:white;text-align:center;">metrics start during warmup</div><div style="margin-top:10px;width:100%; height:2px; background-color:#555555"><div id="cadresistprogress" style="width:0%;transition:990ms linear;height:2px;background-color:white"></div></div>',document.querySelector("div[class='jw-wrapper jw-reset']").after(s);var i=document.getElementById("cadresisttxt"),n=document.getElementById("cadresistprogress");if(e.target_metrics_data.length){s.innerHTML="Class does not have target metrics.",setTimeout(function(){s.innerHTML=""},5e3);return}for(var a=[],c=e.target_metrics_data.target_metrics[0],o=1;o<e.target_metrics_data.target_metrics.length;o++){var p=e.target_metrics_data.target_metrics[o];c.metrics[0].upper==p.metrics[0].upper&&c.metrics[0].lower==p.metrics[0].lower&&c.metrics[1].upper==p.metrics[1].upper&&c.metrics[1].lower==p.metrics[1].lower?c.offsets.end=p.offsets.end:(a.push(c),c=p)}a.push(p),e.instructor_cues=a;var l,d=document.querySelector("div[class='player-overlay-wrapper']");new MutationObserver(function s(a){var c=document.querySelector("p[data-test-id='time-to-complete']");if(c&&2==(c=c.innerHTML.split(":")).length)for(var o=r-(60*Number(c[0])+Number(c[1]))+Number(e.ride.pedaling_start_offset),p=0;p<e.target_metrics_data.target_metrics.length;p++){var l=e.target_metrics_data.target_metrics[p];if(o>=Number(l.offsets.start)&&o<=Number(l.offsets.end)){if("cycling"==l.segment_type){for(var d,_,m=0;m<l.metrics.length;m++)switch(l.metrics[m].name){case"resistance":_=l.metrics[m];break;case"cadence":d=l.metrics[m]}i.innerHTML="cadence: "+d.lower+" - "+d.upper+" &nbsp;&nbsp;&nbsp;&nbsp; resistance: "+t[_.lower]+" - "+t[_.upper]+"&nbsp;&nbsp;&nbsp;&nbsp; ("+_.lower+" - "+_.upper+")"}if("running"==l.segment_type){for(var f,u,m=0;m<l.metrics.length;m++)switch(l.metrics[m].name){case"speed":f=l.metrics[m];break;case"incline":u=l.metrics[m]}i.innerHTML="speed: "+f.lower+" - "+f.upper+" &nbsp;&nbsp;&nbsp;&nbsp; incline: "+u.lower+" - "+u.upper}o==Number(l.offsets.start)?(n.style.transition="none",n.style.width="0%"):(n.style.transition="990ms linear",n.style.width=Math.round((o-l.offsets.start)/(l.offsets.end-l.offsets.start)*100)+"%");return}}}).observe(d,{attributes:!0,childList:!0,subtree:!0,characterData:!0})});
